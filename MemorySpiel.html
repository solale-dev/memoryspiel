<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Memory-Spiel</title>
  <style>
    #memory {
      margin: 1em 9em;
    }
    #MemoryBord {
      background-color: white;
      display: flex;
      flex-wrap: wrap;
    }

    #MemoryBord img {
      display: block;
      width: 100px;
      height: 100px;

    }
  </style>
</head>

<body>

  <h1>Memory Spiel</h1>
  <p>Auswählen wie viele verschiedene <b>Bilder</b> wir für das Memory Spiel verwenden wollen.<br>
    Jede <b>Karte</b> enthält ein Deckblatt und ein Bild. Es sind doppelt so viele Karten wie verschiedene Bilder.
    Karten werden verdeckt gemischt auf einen Spieltisch aufgelegt.<br>
    Anklicken/auswählen einer Karte zeigt das Kartenbild an. Weiteres Anklicken/auswählen einer Karte zeigt auch das
    Kartebild an.<br>
    Wenn das zweite ausgewählte Kartebild nicht mit dem ersten Kartenbild identisch ist, drehen wir die Karten nach 3
    Sekunden wieder um, oder das erneute Anklicken einer dritten Karte dreht die letzten beiden verschiedenen Karten
    wieder um.<br>
    Sonst bei identischen Kartenbildern werden die Karten vom Spieltisch entfernt bzw. durch eine Extrakarte ersetzt.
    Das Spiel ist beendet wenn alle Karten vom Spieltisch entfernt wurden bzw. wenn der Spieler das Spiel abbricht/neu
    beginnt oder das Webseite schließt.
  </p>

  <script>

    var spielfeld = document.getElementById("MemoryBord");
    var verschiedenbilder = 20;
    var bilder = [];
    for (let i = 0; i < verschiedenbilder; i++) {
      let bild;
      do {
        let rnd = Math.floor(Math.random() * 102 + 1);
        bild = "bilder/" + rnd + ".gif";
      } while (bilder.indexOf(bild) > -1);
      bilder[i] = bild;
    }

    var deckblatt = "bilder/DeckBlatt.gif";
    var alternativbild = "bilder/Muster.gif";
    var clone = bilder.slice(0);
    var bilder = bilder.concat(clone);
    var aufgedecktesBild1 = -1;
    var aufgedecktesBild2 = -1;

    function mischen(arr) {
      let rnd1, rnd2, xhelp;
      const len = arr.length;
      for (let i = 0; i < 100; i++) {
        rnd1 = Math.floor(Math.random() * len);
        rnd2 = Math.floor(Math.random() * len);
        xhelp = arr[rnd1];
        arr[rnd1] = arr[rnd2];
        arr[rnd2] = xhelp;
      }
    }
    function steuerung(that, bildnr) {
      let memoryid = document.getElementById("MemoryBord");
      if (bildnr === aufgedecktesBild1 || bildnr === aufgedecktesBild2) return; //nochmal auf Bild geklickt

      if (aufgedecktesBild1 === -1) { // erstes Bild
        aufgedecktesBild1 = bildnr;
        that.src = bilder[bildnr];
        return;
      }
      if (aufgedecktesBild2 === -1) { //zweites Bild
        aufgedecktesBild2 = bildnr;
        that.src = bilder[bildnr];
        return;
      }
      if (bilder[aufgedecktesBild1] === bilder[aufgedecktesBild2]) {
        //entferne Bilder
        memoryid.getElementsByTagName("img")[aufgedecktesBild1].src = "bilder/Muster.gif";
        memoryid.getElementsByTagName("img")[aufgedecktesBild2].src = "bilder/Muster.gif";
        memoryid.getElementsByTagName("img")[aufgedecktesBild1].onclick = "";
        memoryid.getElementsByTagName("img")[aufgedecktesBild2].onclick = "";
      }
      else {
        memoryid.getElementsByTagName("img")[aufgedecktesBild1].src = deckblatt;
        memoryid.getElementsByTagName("img")[aufgedecktesBild2].src = deckblatt;
      }
      aufgedecktesBild2 = -1;
      aufgedecktesBild1 = bildnr;
      that.src = bilder[bildnr];
    }


    mischen(bilder);


  </script>
  <section id="memory">
    Anzahl verschiedener Bilder: <input id="verschiedenbilder" type="number" value="4"><button>Neues Spiel</button>
    <div id="MemoryBord">
      <script>
        for (let i = 0; i < verschiedenbilder; i++) {
          document.writeln('<img src="bilder/DeckBlatt.gif" onclick="steuerung(this, ' + i + ')" />')
        }
      </script>
    </div>
  </section>
</body>


</html>